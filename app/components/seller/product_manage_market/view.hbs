{{#component "product-manage-market js-comp"}}
  <p class="hide">{{json _DATA_}}</p>
  <div class="pull-right">
    <a class="btn btn-minor" href="/seller/release-items?ptype=2">发布商品</a>
  </div>
  <div class="component-header">
    <div name="status" class="tab" data-type="switchable">
      <ul class="tab-navs clearfix">
        <li value="-1"><a
          href="/seller/product-manage-market?step=2">全部<span
          class="tab-label">{{_DATA_.sumCount}}</span></a></li>
        <li value="0"><a
          href="/seller/product-manage-market?step=2&status=1">上架商品<span
          class="tab-label">{{_DATA_.onShelfCount}}</span></a></li>
        <li value="1"><a
          href="/seller/product-manage-market?step=2&status=-1">下架商品<span
          class="tab-label">{{_DATA_.offShelfCount}}</span></a></li>
      </ul>
    </div>
  </div>
  <div class="component-body">
    <div class="search-item">
      <div id="block" class="block filter-block">
        <form class="form">
          <fieldset>
            <span class="span4">
              <label>&nbsp;&nbsp;商品ID&nbsp;&nbsp;
                <input type="text" class="item-filter-item" name="itemId" value="{{itemId}}"
                       placeholder="{{i18n "Product Number (number)" bundle="all_mix"}}">
                <input type="hidden" name="step" value="{{step}}">
              </label>
            </span>
            <span class="span4">
              <label>&nbsp;&nbsp;商品编码&nbsp;&nbsp;
                <input type="text" class="item-filter-item" name="itemCode" value="{{itemCode}}"
                       placeholder="{{i18n "Product Code" bundle="all_mix"}}">
              </label>
            </span>
            <span class="span4">
              <label>&nbsp;&nbsp;商品名称&nbsp;&nbsp;
                <input type="text" class="item-filter-item" name="itemName" value="{{itemName}}"
                       placeholder="{{i18n "Product Name" bundle="all_mix"}}">
              </label>
            </span>
            <br>
            <div class="span4" style="margin-top: 20px;">
              <label>&nbsp;&nbsp;类目&nbsp;&nbsp;&nbsp;&nbsp;</label>
              {{#inject "common/category_select_input"}}
                {"tag": "netsuper"}
              {{/inject}}
            </div>
            <div>
              <span class="span2 pull-right">
                <label for="filter">
                  <button type="submit" class="btn btn-minor js-item-filter">搜索</button>
                  &nbsp;
                  <button type="button" class="btn btn-ghost js-filter-clear">重置</button>
                </label>
              </span>
            </div>

          </fieldset>
        </form>
      </div>
    </div>
    <div class="item-list">
      <table class="table  item-manage-table">
        <thead>
        <tr>
          <th width="24"></th>
          <th width="286" class="left-text">
            {{i18n "Product" bundle="all_mix"}}
          </th>
          <th width="130">{{i18n "Product" bundle="all_mix"}}ID</th>
          <th width="160">类目</th>
          <th width="160">{{i18n "Price" bundle="all_mix"}}</th>
          <th width="100">{{i18n "Inventory " bundle="all_mix"}}</th>
          <th width="80">{{i18n "Total sales" bundle="all_mix"}}</th>
          <th width="100">审核区划</th>
          <th width="100">{{i18n "Status" bundle="all_mix"}}</th>
          <th width="100" class="td-operation">&nbsp;</th>
          <th width="60" class="text-left">{{i18n "Operation " bundle="all_mix"}}</th>
          <th width="20"></th>
        </tr>
        </thead>
        <tbody>
        {{#each _DATA_.result.data}}
          <tr data-id="{{id}}">
            <td>{{#equals status "-2"}}-{{else}}
              <input type="checkbox" class="js-item-select input-checkbox" autocomplete="off">{{/equals}}
            </td>
            <td class="left-text">
              <a href="/items/{{id}}" target="_blank">{{name}}</a><br>
            </td>
            <td>{{id}}</td>
            <td>{{categoryPath}}</td>
            <td>
                            <span class="currency">
                              {{#equals lowPrice highPrice}}
                                {{formatPrice lowPrice}}
                              {{else}}
                                {{formatPrice lowPrice}}-{{formatPrice highPrice}}
                              {{/equals}}
                            </span>
            </td>
            <td>{{stockQuantity}} {{extra.unit}}</td>
            <td>
              {{#equals _USER_.currentCategory 12}}
                －
              {{else}}
                {{#if saleQuantity}}{{saleQuantity}}{{else}}0{{/if}} {{extra.unit}}
              {{/equals}}
            </td>
            <td class="js-divisions-toggle">
              {{#if relations}}
              {{else}}
                --
              {{/if}}
              {{#each relations}}
                <div class="{{#ifCond @index ">" 2}}hide{{/ifCond}} text-ellipsis">
                  {{signDistrictName}}
                </div>
              {{/each}}
            </td>
            <td class="js-status-toggle">
              {{#if relations}}
              {{else}}
                --
              {{/if}}
              {{#each relations}}
                <div class="{{#ifCond @index ">" 2}}hide{{/ifCond}} text-ellipsis">
                  {{#equals status "1"}}<span class="success">已上架</span>{{/equals}}
                  {{#equals status "-1"}}<span>已下架</span>{{/equals}}
                  {{#equals status "0"}}未上架{{/equals}}
                  {{#equals status "-2"}}<span class="color-frizen">已冻结</span>{{/equals}}
                  {{#equals status "2"}}<span class="color-currency">待审核</span>{{/equals}}
                  {{#equals status "-4"}}审核不通过{{/equals}}
                  {{#equals status "5"}}解冻申请中{{/equals}}
                </div>
              {{/each}}
            </td>
            <td class="td-operation js-operate-toggle">
              {{!--{{#withPerm "item_status_update"}}--}}
              {{#if relations}}
              {{else}}
                --
              {{/if}}
              {{#each relations}}
                <div class="{{#ifCond @index ">" 2}}hide{{/ifCond}} text-ellipsis">
                  {{#equals status "5"}}--{{/equals}}
                  {{#equals status "-2"}}
                    <a href="javascript:void(0);" class="js-item-unfrozen"
                       data-districtcode="{{signDistrictCode}}">申请解冻</a><br>
                  {{/equals}}
                  {{#equals status "1"}}
                    <a href="javascript:void(0);" class="js-item-off" data-toggle="confirm"
                       data-title="{{i18n "Are you sure to put it off shelves?" bundle="all_mix"}}"
                       data-content="{{i18n
                         "Can be on-shelf after off-shelf, confirm put it off shelves?"
                         bundle="all_mix"}}" data-event="confirm:off-one" data-districtcode="{{signDistrictCode}}"
                       data-name="{{../name}}">{{i18n "Unlist "
                                                      bundle="all_mix"}}</a>{{/equals}}
                  {{#equals status "-1"}}
                    <a href="javascript:void(0);" class="js-item-on" data-toggle="confirm"
                       data-title="{{i18n "Are you sure to put it on shelves?" bundle="all_mix"}}"
                       data-content="{{i18n
                         "Can be off-shelf after on-shelf, confirm put it on shelves?"
                         bundle="all_mix"}}" data-event="confirm:on-one" data-districtcode="{{signDistrictCode}}"
                       data-name="{{../name}}">{{i18n "List"
                                                      bundle="all_mix"}}</a>{{/equals}}
                  {{#equals status "0"}}
                    <a href="javascript:void(0);" class="js-item-on" data-toggle="confirm"
                       data-title="{{i18n "Are you sure to put it on shelves?" bundle="all_mix"}}"
                       data-content="{{i18n
                         "Can be off-shelf after on-shelf, confirm put it on shelves?"
                         bundle="all_mix"}}" data-event="confirm:on-one" data-districtcode="{{signDistrictCode}}"
                       data-name="{{../name}}">{{i18n "List"
                                                      bundle="all_mix"}}</a>{{/equals}}
                  {{#equals status "-4"}}
                    <a href="javascript:void(0);" class="js-item-on" data-toggle="confirm"
                       data-title="{{i18n "Are you sure to put it on shelves?" bundle="all_mix"}}"
                       data-content="{{i18n
                         "Can be off-shelf after on-shelf, confirm put it on shelves?"
                         bundle="all_mix"}}" data-event="confirm:on-one" data-districtcode="{{signDistrictCode}}"
                       data-name="{{../name}}">{{i18n "List"
                                                      bundle="all_mix"}}</a>{{/equals}}

                  {{#equals auditStatus 1}}
                    <a href="javascript:void(0);" class="cancelAudit"
                       data-product="{{name}}" data-districtcode="{{signDistrictCode}}">撤销审核</a>
                  {{/equals}}
                </div>
              {{/each}}
            </td>
            <td class="text-left">
              <div style="width: 40px">
                <a href="/seller/item-issue?itemId={{id}}&categoryPath={{urlEncode categoryPath "utf-8"}}&ptype=2"
                   target="_blank"
                  {{#equals status "2"}}
                   onclick="return false;"
                  {{/equals}}
                   class="js-edit-item {{#equals status '2'}}disabled{{/equals}}">
                  编辑
                </a>
                {{#withPerm "item_delete"}}
                  <br>
                  <a class="js-item-delete {{#equals status '2'}}disabled{{/equals}}"
                    {{#equals status '2'}}{{else}}
                     data-toggle="confirm"
                     data-title="{{i18n "Are you sure to delete it?" bundle="all_mix"}}"
                     data-content="{{i18n "Cannot be restored after deleting, confirm delete?"
                                          bundle="all_mix"}}"
                     data-event="confirm:delete-one"
                    {{/equals}} >{{i18n "Delete" bundle="all_mix"}}</a>
                {{/withPerm}}
              </div>
            </td>
            {{#gt (size relations) 3}}
              <td class="drawer-btn-container">
                <i class="icon-zcy icon-xiangxiazhedie"></i>
              </td>
            {{else}}
              <td class=""></td>
            {{/gt}}
          </tr>
        {{/each}}
        </tbody>
        <tfoot>
        <tr>
          <td><input type="checkbox" class="js-batch-select input-checkbox" autocomplete="off"></td>
          <td colspan="2">
            {{!--{{#withPerm "item_status_update"}}--}}
            {{#equals status "1"}}
              <button class="btn btn-medium btn-ghost js-item-batch-off">
                {{i18n "Batch offline/unlist "  bundle="all_mix"}}
              </button>
            {{else}}
              <button class="btn btn-medium btn-ghost js-item-batch-on">
                {{i18n "Batch online/listing "  bundle="all_mix"}}
              </button>
            {{/equals}}
            {{!--{{/withPerm}}--}}
          </td>
          <td colspan="9" class="td-operation">
            <div class="item-pagination" data-total="{{_DATA_.result.total}}"
                 data-size="{{#if pageSize ~}}{{pageSize}}{{else}}20{{~/if}}">

            </div>
          </td>
        </tr>
        </tfoot>
      </table>
    </div>
  </div>
{{/component}}
